diff --git a/util/decompile.c b/util/decompile.c
index c844fa49..b573e41f 100644
--- a/util/decompile.c
+++ b/util/decompile.c
@@ -46,6 +46,7 @@
 
 
 static char **pool;
+static unsigned short poolcounter;
 struct SWF_ACTIONPUSHPARAM *regs[256];
 
 static char *getName(struct SWF_ACTIONPUSHPARAM *act);
@@ -345,7 +346,12 @@ getString(struct SWF_ACTIONPUSHPARAM *act)
 		t=malloc(10); /* 32-bit decimal */
 		sprintf(t,"%ld", act->p.Integer );
 		return t;
-	case PUSH_CONSTANT: /* CONSTANT8 */
+	case PUSH_CONSTANT: /* CONSTANT8 */;
+		if (act->p.Constant8 > poolcounter)
+		{
+		        SWF_warn("WARNING: retrieving constants not present in the pool.\n");
+		        break;
+		}
 		t=malloc(strlenext(pool[act->p.Constant8])+3); /* 2 "'"s and a NULL */
 		strcpy(t,"'");
 		strcatext(t,pool[act->p.Constant8]);
@@ -366,7 +372,11 @@ getString(struct SWF_ACTIONPUSHPARAM *act)
 		fprintf (stderr,"  Can't get string for type: %d\n", act->Type);
 		break;
 	}
-	return "";
+	//return "";
+	t = malloc(sizeof(char));
+	strcpyext(t,"");
+
+	return t;
 }
 
 static char *
@@ -417,6 +427,10 @@ getName(struct SWF_ACTIONPUSHPARAM *act)
 	default: 
 		return getString(act);
 	}
+	t = malloc(sizeof(char));
+	strcpyext(t,"");
+
+	return t;
 }
 
 static int
@@ -728,6 +742,7 @@ decompileCONSTANTPOOL (SWF_ACTION *act)
 {
 	OUT_BEGIN(SWF_ACTIONCONSTANTPOOL);
 	pool=sact->ConstantPool;
+	poolcounter = sact->Count;
 }
 
 static void
@@ -3411,6 +3426,7 @@ decompile5Action(int n, SWF_ACTION *actions,int indent)
 		return NULL;
 
 	pool = NULL;
+	poolcounter = 0;
 
 	dcinit();
 
